<!DOCTYPE>

<html>
  <head>
    <script type="text/javascript" src="js/lib/underscore-min.js"></script>
    <script type="text/javascript" src="js/lib/phaser.min.js"></script>
  </head>

  <script type="text/javascript">
    var game = new Phaser.Game(400, 400, Phaser.AUTO, '', { preload: preload, create: create, update: update });

    var player;
    var baddies;
    var cursors;

    function preload(){
      game.load.image('star', 'assets/star.png');
      game.load.image('mushroom', 'assets/mushroom.png');
    }

    function create(){
      // Player
      player = game.add.sprite((game.world.width / 2) - 12, (game.world.height / 2) - 11, 'star');
      game.physics.enable(player, Phaser.Physics.ARCADE);
      player.body.collideWorldBounds = true;

      // Baddies
      baddies = game.add.group();

      game.time.events.loop(Phaser.Timer.SECOND * 0.25, function(i){
          if(_.random(0, 1) === 0){
            var startX = _.random(0, 400);
            if(_.random(0, 1) === 0){
              var startY = -25;
            } else {
              var startY = 425;  
            }
            var velX = startX > 200 ? _.random(-150, -50) : _.random(50, 150);
            var velY = startY > 0 ? -150 + Math.abs(velX) : 150 - Math.abs(velX);
          } else {
            var startY = _.random(0, 400);
            if(_.random(0, 1) === 0){
              var startX = -26;
            } else {
              var startX = 426;  
            }
            var velY = startY > 200 ? _.random(-150, -50) : _.random(50, 150);
            var velX = startX > 0 ? -150 + Math.abs(velY) : 150 - Math.abs(velY);
          }

          var baddy = baddies.create(startX, startY, 'mushroom');
          game.physics.enable(baddy, Phaser.Physics.ARCADE);
          baddy.body.velocity.x = velX;
          baddy.body.velocity.y = velY;
      }, this);

      cursors = game.input.keyboard.createCursorKeys();
    }

    function update(){
      game.physics.arcade.overlap(player, baddies, killPlayer, null, this);

      // Player
      player.body.velocity.x = 0;
      player.body.velocity.y = 0;

      if (cursors.left.isDown) {
        player.body.velocity.x = -150;
      } else if (cursors.right.isDown){
        player.body.velocity.x = 150;
      } else if (cursors.up.isDown){
        player.body.velocity.y = -150;
      } else if (cursors.down.isDown){
        player.body.velocity.y = 150;
      }

      // Baddies
    }

    function killPlayer(player, baddy){
      player.kill();
    }

  </script>

  <body>
  </body>
</html>


